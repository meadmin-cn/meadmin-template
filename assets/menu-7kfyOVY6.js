import{_ as g}from"./index-DPlHoWsj.js";import{m as q,t as D,s as F,A as R,d as S}from"./add-DTWUkah4.js";import{bB as K,ap as N,_ as U}from"./index-gAuTWnPj.js";import{E as w}from"./index-DEe-wAkk.js";import{o as j}from"./omit-B_u2yBmR.js";import{E as L}from"./index-DN3M8rqg.js";import{d as A,r as p,A as O,i as u,c as Q,o as V,k as t,u as s,F as b,w as i,j as z,E as G}from"./core-C4-oPvXL.js";import"./pagination-BmVlXqXF.js";import"./elIcon-CvLeSQbC.js";import"./index-BK-tAmL-.js";import"./index-CSbSf2hP.js";import"./strings-wN4GZIAz.js";import"./castArray-DUEINfxs.js";import"./index-CXi-HPtR.js";import"./event-BB_Ol6Sd.js";import"./scroll-CkTYXBUz.js";import"./index-BZ4rUAOC.js";import"./mock-DBzxB1z9.js";import"./index-QECcLlNb.js";import"./dropdown-Dxc3fwJq.js";import"./index-YdNnni6d.js";import"./index-DlNmoOEa.js";import"./index-hqSl7NKM.js";import"./index-DviC_746.js";import"./index-BUHB6SMc.js";import"./index-Cyirvej5.js";import"./index-qNnqtpjd.js";import"./index-BRJ7oqSm.js";import"./index-CMAgUPwQ.js";import"./refs-BScKkwek.js";import"./isPlainObject-iAcVfnk8.js";import"./validator-5BzNceBX.js";const H={clss:"menu"},J=A({setup:!0,name:"Menu",getComponents:()=>[u("vxe-column"),u("mel-icon-edit"),w,u("mel-icon-delete"),g,R]}),P=A({...J,__name:"menu",props:{checkedRules:{type:Array,default:()=>[]}},emits:["subRules"],setup(C,{emit:T}){const _=C,E=T,m=p(!1),r=p(),a=q();O(()=>[_.checkedRules,a.data.value],async()=>{!a.data.value||!a.data.value.length||(await r.value.vxeTableRef.clearCheckboxRow(),r.value.vxeTableRef.setCheckboxRow(_.checkedRules.reduce((n,e)=>{const l=r.value.vxeTableRef.getRowById(e);return l.children||n.push(l),n},[]),!0))});let h=[];const c=p(""),k=n=>{a.data.value=K(n,["name","rule"],h),G(()=>r.value.vxeTableRef.setAllTreeExpand(!0))},d=async()=>{await a.runAsync(),h=N(a.data.value),k(c.value)};d();const x=p(),y=n=>{x.value=n?j(n,["children"]):void 0,m.value=!0},B=n=>{L.confirm("确认删除所选菜单?").then(()=>{S().runAsync(n).then(d)}).catch(()=>{})};return(n,e)=>{const l=u("vxe-column"),M=u("mel-icon-edit"),f=w,$=u("mel-icon-delete"),I=g;return V(),Q("div",H,[t(I,{ref_key:"menuRef",ref:r,"quick-search":s(c),"onUpdate:quickSearch":e[1]||(e[1]=o=>b(c)?c.value=o:null),data:s(a).data.value??[],loading:s(a).loading.value,"custom-column":!1,"tree-config":{expandAll:!0,line:!0,reserve:!0},"checkbox-config":{labelField:"id"},"row-config":{keyField:"rule",useKey:!0},"column-config":{useKey:!0},align:"center",border:"","me-class":"table-menu",height:"auto","show-overflow":"",onRefresh:d,onQuickSearch:k,onAdd:e[2]||(e[2]=o=>y())},{toolsButton:i(()=>[t(f,{type:"success",onClick:e[0]||(e[0]=o=>E("subRules",s(r).vxeTableRef.getCheckboxRecords(!0).map(v=>v.rule)))},{default:i(()=>e[5]||(e[5]=[z("保存")])),_:1})]),default:i(()=>[t(l,{type:"checkbox",title:"ID","tree-node":"",width:"240px",align:"left","header-align":"center"}),t(l,{field:"name",title:"菜单",type:"html"}),t(l,{field:"rule",title:"规则",type:"html"}),t(l,{field:"type",title:"类型",formatter:({row:o})=>D[o.type]},null,8,["formatter"]),t(l,{field:"sort",title:"排序"}),t(l,{field:"status",title:"状态",formatter:({row:o})=>F[o.status]},null,8,["formatter"]),t(l,{title:"操作"},{default:i(({row:o})=>[t(f,{type:"primary",link:"",onClick:v=>y(o)},{default:i(()=>[t(M)]),_:2},1032,["onClick"]),t(f,{type:"danger",link:"",onClick:v=>B(o.id)},{default:i(()=>[t($)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["quick-search","data","loading"]),t(R,{show:s(m),"onUpdate:show":e[3]||(e[3]=o=>b(m)?m.value=o:null),data:s(x),onSuccess:e[4]||(e[4]=o=>d())},null,8,["show","data"])])}}}),Ee=U(P,[["__scopeId","data-v-46c8b760"]]);export{Ee as default};
