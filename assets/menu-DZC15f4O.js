import{_ as M}from"./index-Dw83nXmd.js";import{m as $,t as I,s as q,A as D,d as F}from"./add-7h6VNVTj.js";import{bB as S,ap as K,aP as L,_ as N}from"./index-pAeQZ1-G.js";import{E as U}from"./index-yTwIwyY4.js";import{E as j}from"./index-DX8iX1cV.js";import{d as g,r as d,C as z,i as v,c as O,o as P,k as t,u as s,F as b,w as i,j as Q,z as V}from"./core-DgTHnQpx.js";import"./pagination-JlVISjBV.js";import"./elIcon-DHXrp9ew.js";import"./index-6UX7B9cc.js";import"./index-DjgP1kfQ.js";import"./strings-SjbtM2e1.js";import"./castArray-B4jZf3Od.js";import"./index-BqQg0EVn.js";import"./event-BB_Ol6Sd.js";import"./scroll-C-BcuyVu.js";import"./index-DCjaOx1S.js";import"./mock-h91I9qF-.js";import"./index-Fxq-ji8x.js";import"./dropdown-ehv5OB2i.js";import"./index-C673HT9H.js";import"./index-BEhH5FRK.js";import"./index-BVaSujfL.js";import"./index-DHCz5-7b.js";import"./index-Cu8ks7sa.js";import"./index-D32QnYWd.js";import"./index-Cj9wNU57.js";import"./index-CdVB_pP8.js";import"./index-COYC1Rw2.js";import"./refs-vhJOtpGo.js";import"./validator-C14abE9R.js";const G={clss:"menu"},H=g({setup:!0,name:"Menu"}),J=g({...H,__name:"menu",props:{checkedRules:{type:Array,default:()=>[]}},emits:["subRules"],setup(w,{emit:R}){const _=w,C=R,u=d(!1),r=d(),l=$();z(()=>[_.checkedRules,l.data.value],async()=>{!l.data.value||!l.data.value.length||(await r.value.vxeTableRef.clearCheckboxRow(),r.value.vxeTableRef.setCheckboxRow(_.checkedRules.reduce((n,e)=>{const a=r.value.vxeTableRef.getRowById(e);return a.children||n.push(a),n},[]),!0))});let h=[];const m=d(""),k=n=>{l.data.value=S(n,["name","rule"],h),V(()=>r.value.vxeTableRef.setAllTreeExpand(!0))},c=async()=>{await l.runAsync(),h=K(l.data.value),k(m.value)};c();const x=d(),y=n=>{x.value=n?L(n,["children"]):void 0,u.value=!0},A=n=>{j.confirm("确认删除所选菜单?").then(()=>{F().runAsync(n).then(c)}).catch(()=>{})};return(n,e)=>{const a=v("vxe-column"),T=v("mel-icon-edit"),p=U,B=v("mel-icon-delete"),E=M;return P(),O("div",G,[t(E,{ref_key:"menuRef",ref:r,"quick-search":s(m),"onUpdate:quickSearch":e[1]||(e[1]=o=>b(m)?m.value=o:null),data:s(l).data.value??[],loading:s(l).loading.value,"custom-column":!1,"tree-config":{expandAll:!0,showLine:!0,reserve:!0},"checkbox-config":{labelField:"id"},"row-config":{keyField:"rule",useKey:!0},"column-config":{useKey:!0},align:"center",border:"","me-class":"table-menu",height:"auto","show-overflow":"",onRefresh:c,onQuickSearch:k,onAdd:e[2]||(e[2]=o=>y())},{toolsButton:i(()=>[t(p,{type:"success",onClick:e[0]||(e[0]=o=>C("subRules",s(r).vxeTableRef.getCheckboxRecords(!0).map(f=>f.rule)))},{default:i(()=>e[5]||(e[5]=[Q("保存")])),_:1})]),default:i(()=>[t(a,{type:"checkbox",title:"ID","tree-node":"",width:"240px",align:"left","header-align":"center"}),t(a,{field:"name",title:"菜单",type:"html"}),t(a,{field:"rule",title:"规则",type:"html"}),t(a,{field:"type",title:"类型",formatter:({row:o})=>I[o.type]},null,8,["formatter"]),t(a,{field:"sort",title:"排序"}),t(a,{field:"status",title:"状态",formatter:({row:o})=>q[o.status]},null,8,["formatter"]),t(a,{title:"操作"},{default:i(({row:o})=>[t(p,{type:"primary",link:"",onClick:f=>y(o)},{default:i(()=>[t(T)]),_:2},1032,["onClick"]),t(p,{type:"danger",link:"",onClick:f=>A(o.id)},{default:i(()=>[t(B)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["quick-search","data","loading"]),t(D,{show:s(u),"onUpdate:show":e[3]||(e[3]=o=>b(u)?u.value=o:null),data:s(x),onSuccess:e[4]||(e[4]=o=>c())},null,8,["show","data"])])}}}),Ae=N(J,[["__scopeId","data-v-ba363cc0"]]);export{Ae as default};
